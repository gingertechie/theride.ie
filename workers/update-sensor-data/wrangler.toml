name = "update-sensor-data"
main = "index.ts"
compatibility_date = "2024-11-28"

# Schedule: Runs hourly to fetch incremental sensor data
# Each sensor fetches from its latest database timestamp to now
# Rate limited to 5 seconds between API calls to respect Telraam limits
# Cron format: minute hour day month day-of-week
# Can be changed without affecting logic - worker is schedule-agnostic
[triggers]
crons = ["*/5 0-4 * * *"]

# D1 Database binding (same database as main app)
[[d1_databases]]
binding = "DB"
database_name = "theride-db"
database_id = "86c35cca-68fd-4d93-8d4a-c7a3ab463b10"

# Telraam API Key (set via: wrangler secret put TELRAAM_API_KEY)
# This will be stored securely in Cloudflare and not in the code

# Observability: Enable logging for monitoring and debugging
[observability]
enabled = true

[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
